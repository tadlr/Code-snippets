!function(){function t(t){var e=t||{};this.d=this.c=p,void 0==t.visible&&(t.visible=a),void 0==t.shadow&&(t.shadow="7px -3px 5px rgba(88,88,88,0.7)"),void 0==t.anchor&&(t.anchor=g.BOTTOM),this.setValues(e)}function e(t,e){if(t.c){var o="";-1!==navigator.userAgent.indexOf("Gecko/")?("dragging"==e&&(o="-moz-grabbing"),"dragready"==e&&(o="-moz-grab")):"dragging"!=e&&"dragready"!=e||(o="move"),"draggable"==e&&(o="pointer"),t.a.style.cursor!=o&&(t.a.style.cursor=o)}}function o(t,o){if(t.getDraggable()&&!t.d){t.d=a;var r=t.getMap();t.m=r.get("draggable"),r.set("draggable",p),t.h=o.clientX,t.i=o.clientY,e(t,"dragready"),t.a.style.MozUserSelect="none",t.a.style.KhtmlUserSelect="none",t.a.style.WebkitUserSelect="none",t.a.unselectable="on",t.a.onselectstart=function(){return p},function(t){t.a.setCapture?(t.a.setCapture(a),t.e=[google.maps.event.addDomListener(t.a,"mousemove",function(e){n(t,e)},a),google.maps.event.addDomListener(t.a,"mouseup",function(){i(t),t.a.releaseCapture()},a)]):t.e=[google.maps.event.addDomListener(window,"mousemove",function(e){n(t,e)},a),google.maps.event.addDomListener(window,"mouseup",function(){i(t)},a)]}(t),google.maps.event.trigger(t,"dragstart")}}function i(t){t.getDraggable()&&t.d&&(t.d=p,t.getMap().set("draggable",t.m),t.h=t.i=t.m=null,t.a.style.MozUserSelect="",t.a.style.KhtmlUserSelect="",t.a.style.WebkitUserSelect="",t.a.unselectable="off",t.a.onselectstart=function(){},function(t){if(t.e){for(var e,o=0;e=t.e[o];o++)google.maps.event.removeListener(e);t.e.length=0}}(t),e(t,"draggable"),google.maps.event.trigger(t,"dragend"),t.draw())}function n(t,o){if(t.getDraggable()&&t.d){var n=t.h-o.clientX,r=t.i-o.clientY;t.h=o.clientX,t.i=o.clientY,n=parseInt(t.a.style.left,10)-n,r=parseInt(t.a.style.top,10)-r,t.a.style.left=n+"px",t.a.style.top=r+"px";var a=s(t);t.setPosition(t.getProjection().fromDivPixelToLatLng(new google.maps.Point(n-a.width,r-a.height))),e(t,"dragging"),google.maps.event.trigger(t,"drag")}else i(t)}function r(t){t.f&&(google.maps.event.removeListener(t.f),delete t.f),e(t,"")}function s(t){var e=t.l();if("object"==typeof e)return e;var o=new google.maps.Size(0,0);if(!t.b)return o;var i=t.b.offsetWidth;switch(t=t.b.offsetHeight,e){case g.TOP:o.width=-i/2;break;case g.TOP_RIGHT:o.width=-i;break;case g.LEFT:o.height=-t/2;break;case g.MIDDLE:o.width=-i/2,o.height=-t/2;break;case g.RIGHT:o.width=-i,o.height=-t/2;break;case g.BOTTOM_LEFT:o.height=-t;break;case g.BOTTOM:o.width=-i/2,o.height=-t;break;case g.BOTTOM_RIGHT:o.width=-i,o.height=-t}return o}var a=!0,p=!1;t.prototype=new google.maps.OverlayView,window.RichMarker=t,t.prototype.getVisible=function(){return this.get("visible")},t.prototype.getVisible=t.prototype.getVisible,t.prototype.setVisible=function(t){this.set("visible",t)},t.prototype.setVisible=t.prototype.setVisible,t.prototype.s=function(){this.c&&(this.a.style.display=this.getVisible()?"":"none",this.draw())},t.prototype.visible_changed=t.prototype.s,t.prototype.setFlat=function(t){this.set("flat",!!t)},t.prototype.setFlat=t.prototype.setFlat,t.prototype.getFlat=function(){return this.get("flat")},t.prototype.getFlat=t.prototype.getFlat,t.prototype.p=function(){return this.get("width")},t.prototype.getWidth=t.prototype.p,t.prototype.o=function(){return this.get("height")},t.prototype.getHeight=t.prototype.o,t.prototype.setShadow=function(t){this.set("shadow",t),this.g()},t.prototype.setShadow=t.prototype.setShadow,t.prototype.getShadow=function(){return this.get("shadow")},t.prototype.getShadow=t.prototype.getShadow,t.prototype.g=function(){this.c&&(this.a.style.boxShadow=this.a.style.webkitBoxShadow=this.a.style.MozBoxShadow=this.getFlat()?"":this.getShadow())},t.prototype.flat_changed=t.prototype.g,t.prototype.setZIndex=function(t){this.set("zIndex",t)},t.prototype.setZIndex=t.prototype.setZIndex,t.prototype.getZIndex=function(){return this.get("zIndex")},t.prototype.getZIndex=t.prototype.getZIndex,t.prototype.t=function(){this.getZIndex()&&this.c&&(this.a.style.zIndex=this.getZIndex())},t.prototype.zIndex_changed=t.prototype.t,t.prototype.getDraggable=function(){return this.get("draggable")},t.prototype.getDraggable=t.prototype.getDraggable,t.prototype.setDraggable=function(t){this.set("draggable",!!t)},t.prototype.setDraggable=t.prototype.setDraggable,t.prototype.k=function(){this.c&&(this.getDraggable()?function(t,i){i&&(t.f=google.maps.event.addDomListener(i,"mousedown",function(e){o(t,e)}),e(t,"draggable"))}(this,this.a):r(this))},t.prototype.draggable_changed=t.prototype.k,t.prototype.getPosition=function(){return this.get("position")},t.prototype.getPosition=t.prototype.getPosition,t.prototype.setPosition=function(t){this.set("position",t)},t.prototype.setPosition=t.prototype.setPosition,t.prototype.q=function(){this.draw()},t.prototype.position_changed=t.prototype.q,t.prototype.l=function(){return this.get("anchor")},t.prototype.getAnchor=t.prototype.l,t.prototype.r=function(t){this.set("anchor",t)},t.prototype.setAnchor=t.prototype.r,t.prototype.n=function(){this.draw()},t.prototype.anchor_changed=t.prototype.n,t.prototype.setContent=function(t){this.set("content",t)},t.prototype.setContent=t.prototype.setContent,t.prototype.getContent=function(){return this.get("content")},t.prototype.getContent=t.prototype.getContent,t.prototype.j=function(){if(this.b){!function(t,e){if(e)for(var o;o=e.firstChild;)e.removeChild(o)}(0,this.b);var t=this.getContent();if(t){"string"==typeof t&&(t=function(t,e){var o=document.createElement("DIV");if(o.innerHTML=e,1==o.childNodes.length)return o.removeChild(o.firstChild);for(var i=document.createDocumentFragment();o.firstChild;)i.appendChild(o.firstChild);return i}(0,t=t.replace(/^\s*([\S\s]*)\b\s*$/,"$1"))),this.b.appendChild(t);var e=this;t=this.b.getElementsByTagName("IMG");for(var o,i=0;o=t[i];i++)google.maps.event.addDomListener(o,"mousedown",function(t){e.getDraggable()&&(t.preventDefault&&t.preventDefault(),t.returnValue=p)}),google.maps.event.addDomListener(o,"load",function(){e.draw()});google.maps.event.trigger(this,"domready")}this.c&&this.draw()}},t.prototype.content_changed=t.prototype.j,t.prototype.onAdd=function(){if(this.a||(this.a=document.createElement("DIV"),this.a.style.position="absolute"),this.getZIndex()&&(this.a.style.zIndex=this.getZIndex()),this.a.style.display=this.getVisible()?"":"none",!this.b){this.b=document.createElement("DIV"),this.a.appendChild(this.b);var t=this;google.maps.event.addDomListener(this.b,"click",function(){google.maps.event.trigger(t,"click")}),google.maps.event.addDomListener(this.b,"mouseover",function(){google.maps.event.trigger(t,"mouseover")}),google.maps.event.addDomListener(this.b,"mouseout",function(){google.maps.event.trigger(t,"mouseout")})}this.c=a,this.j(),this.g(),this.k();var e=this.getPanes();e&&e.overlayImage.appendChild(this.a),google.maps.event.trigger(this,"ready")},t.prototype.onAdd=t.prototype.onAdd,t.prototype.draw=function(){if(this.c&&!this.d){var t=this.getProjection();if(t){var e=this.get("position");t=t.fromLatLngToDivPixel(e),e=s(this),this.a.style.top=t.y+e.height+"px",this.a.style.left=t.x+e.width+"px",t=this.b.offsetHeight,(e=this.b.offsetWidth)!=this.get("width")&&this.set("width",e),t!=this.get("height")&&this.set("height",t)}}},t.prototype.draw=t.prototype.draw,t.prototype.onRemove=function(){this.a&&this.a.parentNode&&this.a.parentNode.removeChild(this.a),r(this)},t.prototype.onRemove=t.prototype.onRemove;var g={TOP_LEFT:1,TOP:2,TOP_RIGHT:3,LEFT:4,MIDDLE:5,RIGHT:6,BOTTOM_LEFT:7,BOTTOM:8,BOTTOM_RIGHT:9};window.RichMarkerPosition=g}();